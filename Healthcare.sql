CREATE DATABASE HEALTHCARE;
USE HEALTHCARE;
SELECT*FROM HEALTH_CARE_SQL;

-- QUESTION 1: RETRIEVE THE NAMES OF ALL PATIENTS IN THE DATABASE.
SELECT NAME FROM HEALTH_CARE_SQL;

-- QUESTION 2: LIST THE UNIQUE MEDICAL CONDITIONS PRESENT IN THE DATASET.
SELECT DISTINCT MEDICAL_CONDITION FROM HEALTH_CARE_SQL;

-- QUESTION 3: FIND THE TOTAL NUMBER OF DOCTORS IN THE HEALTHCARE SYSTEM.
SELECT COUNT(*) AS TOTAL_DOCTORS FROM HEALTH_CARE_SQL;

-- QUESTION 4: RETRIEVE THE DETAILS OF ALL FEMALE PATIENTS.
SELECT * FROM HEALTH_CARE_SQL
WHERE GENDER = 'FEMALE';

-- QUESTION 5: WHAT IS THE AVERAGE AGE OF PATIENTS IN THE DATABASE.
SELECT AVG(AGE) AS AVERAGE_AGE FROM HEALTH_CARE_SQL;

-- QUESTION 6: IDENTIFY THE PATIENTS WHO HAVE MORE THAN ONE MEDICAL CONDITION.
SELECT NAME FROM HEALTH_CARE_SQL
WHERE LENGTH(MEDICAL_CONDITION) - LENGTH(REPLACE(MEDICAL_CONDITION, ',', '')) + 1 > 1;

-- QUESTION 7: LIST THE NAMES OF ALL DOCTORS.
SELECT DOCTOR FROM HEALTH_CARE_SQL;

-- QUESTION 8: IDENTIFY THE MOST COMMON MEDICAL CONDITION AMONG PATIENTS.
SELECT MEDICAL_CONDITION, COUNT(*) AS FREQUENCY FROM HEALTH_CARE_SQL
GROUP BY MEDICAL_CONDITION ORDER BY FREQUENCY DESC LIMIT 1;

-- QUESTION 9: FIND THE PATIENTS WHO ARE OLDER THAN 60 YEARS AND HAVE DIABETES.
SELECT NAME FROM HEALTH_CARE_SQL
WHERE AGE > 60 AND MEDICAL_CONDITION LIKE '%DIABETES%';

-- QUESTION 10: CALCULATE THE TOTAL REVENUE GENERATED BY THE HEALTHCARE SYSTEM.
SELECT SUM(BILLING_AMOUNT) AS TOTAL_REVENUE FROM HEALTH_CARE_SQL;

-- QUESTION 11: FIND THE DOCTOR WITH THE OLDEST PATIENT.
SELECT DOCTOR FROM HEALTH_CARE_SQL ORDER BY AGE DESC LIMIT 4;

-- QUESTION 12: CALCULATE THE AVERAGE DURATION OF MEDICAL VISITS.
SELECT AVG(ABS(DURATION)) AS AVERAGE_DURATION FROM HEALTH_CARE_SQL;

-- QUESTION 13: GIVE THE NAMES OF PATIENTS WHOSE NAME STARTS WITH 'A'.
SELECT NAME FROM HEALTH_CARE_SQL
WHERE NAME LIKE 'A%';

-- QUESTION 14: HOW MANY MALE AND FEMALE PATIENTS ARE THERE IN DATASET.
SELECT GENDER, COUNT(*) AS TOTAL FROM HEALTH_CARE_SQL
GROUP BY GENDER;

-- QUESTION 15: HOW MANY PATIENTS ARE NORMAL.
SELECT COUNT(*) AS TOTAL_NORMAL_PATIENTS FROM HEALTH_CARE_SQL
WHERE TEST_RESULTS = 'NORMAL';

-- QUESTION 16: HOW MANY PATIENTS ARE ABNORMAL OR INCONCLUSIVE.
SELECT COUNT(*) AS TOTAL_ABNORMAL_INCONCLUSIVE FROM HEALTH_CARE_SQL
WHERE TEST_RESULTS IN ('ABNORMAL', 'INCONCLUSIVE');

-- QUESTION 17: HOW MANY PATIENTS OF BLOOD GROUP AB+ ARE THERE OF AGE ABOVE 52.
SELECT COUNT(*) AS TOTAL_AB_PLUS_ABOVE_52 FROM HEALTH_CARE_SQL
WHERE BLOOD_TYPE = 'AB+' AND AGE > 52;

-- QUESTION 18: HOW MANY PATIENTS HAVE PAID THE BILL ABOVE 24,890.
SELECT COUNT(*) AS TOTAL_PAID_ABOVE_24890 FROM HEALTH_CARE_SQL
WHERE BILLING_AMOUNT > 24890;

-- QUESTION 19: WHAT ARE THE NAMES OF PATIENTS HAVING ASTHMA.
SELECT NAME FROM HEALTH_CARE_SQL
WHERE MEDICAL_CONDITION LIKE '%ASTHMA%';

-- QUESTION 20: HOW MANY PATIENTS HAVE CANCER.
SELECT COUNT(*) AS TOTAL_CANCER_PATIENTS FROM HEALTH_CARE_SQL
WHERE MEDICAL_CONDITION LIKE '%CANCER%';

-- QUESTION 21: WHAT ARE THE NAMES AND BLOOD GROUPS OF PATIENTS ADMITTED TO ROOM NO. 292.
SELECT NAME, BLOOD_TYPE FROM HEALTH_CARE_SQL
WHERE ROOM_NUMBER = 292;

-- QUESTION 22: HOW MANY MALES HAVE ARTHRITIS.
SELECT COUNT(*) AS TOTAL_MALES_WITH_ARTHRITIS FROM HEALTH_CARE_SQL
WHERE GENDER = 'MALE' AND MEDICAL_CONDITION LIKE '%ARTHRITIS%';

-- QUESTION 23: HOW MANY PATIENTS WERE ADMITTED TO HARRIS AND SONS HOSPITAL.
SELECT COUNT(*) AS TOTAL_PATIENTS_IN_HARRIS_AND_SONS FROM HEALTH_CARE_SQL
WHERE HOSPITAL = 'HARRIS AND SONS';

-- QUESTION 24: WHAT ARE THE NAMES OF PATIENTS WHOSE INSURANCE PROVIDER IS CIGNA.
SELECT NAME FROM HEALTH_CARE_SQL
WHERE INSURANCE_PROVIDER = 'CIGNA';

-- QUESTION 25: NAME THE MEDICAL CONDITION WITH PATIENTS WHOSE AGE IS GREATER THAN AVERAGE AGE.
SELECT DISTINCT MEDICAL_CONDITION FROM HEALTH_CARE_SQL
WHERE AGE > (SELECT AVG(AGE) FROM HEALTH_CARE_SQL);
